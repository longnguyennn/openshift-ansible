---
- include: determine_version.yaml

# allow passing in a tempdir
- name: Create temp directory for doing work in
  command: mktemp -d /tmp/openshift-logging-ansible-XXXXXX
  register: mktemp
  changed_when: False
  check_mode: no
  when: not openshift_logging_tempdir or openshift_logging_tempdir == ''

- set_fact:
    tempdir: "{{ mktemp.stdout }}"
  when: not openshift_logging_tempdir

- set_fact:
    tempdir: "{{ openshift_logging_tempdir }}"
  when: openshift_logging_tempdir

# This may not be necessary in this role
- name: Create templates subdirectory
  file:
    state: directory
    path: "{{ tempdir }}/templates"
    mode: 0755
  changed_when: False
  check_mode: no
  when: not openshift_logging_tempdir or openshift_logging_tempdir == ''

# we want to make sure we have all the necessary components here

# service account
# configmap
# secret

- set_fact:
    es_component: "{{ 'logging-curator' ~ ( (openshift_logging_curator_ops_deployment | default(false) | bool) | ternary('-ops', '') ) }}"

# DC
# scale up


- name: Delete temp directory
  file:
    name: "{{ tempdir }}"
    state: absent
  changed_when: False
  check_mode: no
  when: not openshift_logging_tempdir or openshift_logging_tempdir == ''
